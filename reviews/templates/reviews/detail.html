{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% block content %}
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{message.tags}} alert-dismissible fade show" role="alert">
        <div class="container">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        {% endfor %}
      {% endif %}

      <div class="mt-3">
        <h5>댓글</h5>
        {% if comments %}
          <p>댓글 :
            {{ comments|length}}
            개</p>
        {% endif %}
        {% if request.user.is_authenticated %}
          <form action="{% url 'reviews:comment_create' review.pk %}" method="POST">
            {% csrf_token %}
            {% bootstrap_form comment_form %}
            <button class="btn btn-outline-primary" type="submit">등록</button>
          </form>
        {% endif %}
        <div>
          <ul class="list-group list-group-flush">
            {% for comment in comments %}
              <li class="list-group-item">
                {{comment.user.username}}
                |
                {{ comment.content }}
                <span>|
                  {{ comment.created_at }}</span>
                {% if request.user == comment.user %}
                  <form action="{% url 'articles:comment_delete' review.pk comment.pk %}" method="POST">
                    {% csrf_token %}
                    <button class="btn btn-outline-danger" type="submit">삭제</button>
                  </form>
                {% endif %}
              </li>
              {% empty %}
              <li class="list-group-item">
                작성된 댓글이 없습니다.
              </li>
            </ul>
          {% endfor %}
        </div>
      </div>
    {% endblock content %}
